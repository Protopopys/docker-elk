version: "3.6"

services:

  metricbeat:
    volumes:
      - ${METRICBEAT_DATA:-/elk/metricbeat}:/usr/share/metricbeat/data:rw
      - $PWD/beats/metricbeat/config/metricbeat.yml:/usr/share/metricbeat/metricbeat.yml:ro
    environment:
      ELASTICSEARCH_HOST: ${ELASTICSEARCH_HOST:-http://elasticsearch:9200}
      KIBANA_HOST: ${KIBANA_HOST:-http://kibana:5601}
    restart: on-failure
networks:
  metricbeat:
    driver: bridge
