version: "3.6"

services:

  heartbeat:
    hostname: "{{.Node.Hostname}}-heartbeat"
    configs:
      - source: heartbeat_config
        target: /usr/share/heartbeat/heartbeat.yml
    volumes:
      - heartbeat:/usr/share/heartbeat/data
    environment:
      - ELASTICSEARCH_HOST=${ELASTICSEARCH_HOST:-node1}
      - KIBANA_HOST=${KIBANA_HOST:-node1}
    deploy:
      mode: global

networks:
  heartbeat:
    external: true

volumes:
  heartbeat:

configs:
  heartbeat_config:
    heart: $PWD/beats/heartbeat/config/heartbeat.yml